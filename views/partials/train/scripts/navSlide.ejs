<!-- Change to min after production -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.1.3/socket.io.js"></script>

<script>
    var $prog = $('#progCount');
    var completed = 0;
    var initTotal = Reveal.getTotalSlides();
    var socket = io({secure: true});
    function doNext(){
        var id = $(Reveal.getCurrentSlide().parentNode).data('slide');
        Reveal.right();
        adjustText(Reveal.getCurrentSlide());
        completed++;
        updateProg((completed / initTotal) * 100);
        socket.emit('markClue', id);

    }
    function doPrev(){
        var $slide = $(Reveal.getCurrentSlide().parentNode);

        //Add slide to stack between 7 and 25 elements from current index
        var rand = randomIntFromInterval(7,25)
        var $chosen = $slide.nextAll().slice(rand, rand+1);
        $slide.insertAfter($chosen);

        //Move after insertion
        Reveal.right();
        adjustText(Reveal.getCurrentSlide());
    }

    function doUp(){
        Reveal.up();
        adjustText(Reveal.getCurrentSlide());
    }
    function doDown() {
        Reveal.down();
        adjustText(Reveal.getCurrentSlide());
    }

    function doRight(){
        Reveal.right();
    }

    function doLeft(){
        Reveal.left();
        adjustText(Reveal.getCurrentSlide());
        completed--;
        updateProg((completed / initTotal) * 100);

    }

    function updateProg(prog){
        $prog.width(prog+'%');
    }

    function randomIntFromInterval(min, max) { // min and max included
        return Math.floor(Math.random() * (max - min + 1) + min)
    }

</script>